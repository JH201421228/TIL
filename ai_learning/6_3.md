# MSE vs BCE  
**정의**:

- **MSE(Mean Squared Error)**: 예측 확률 q와 정답 y의 차이를 제곱해 평균하는 손실.
- **BCE(Binary Cross-Entropy, 로그손실/Log Loss)**: 정답 클래스의 예측 확률을 로그로 벌주는(정답일수록 $\log q$ 작아짐) 손실.

**핵심 아이디어**:

- 이진 분류에서 **시그모이드(sigmoid)** 출력 $q=\sigma(z)$를 쓸 때, **BCE는 기울기(gradient)가 크고 안정적**이어서 학습 신호가 잘 흐르고(특히 오답에 강한 페널티), **MSE는 시그모이드의 포화(saturation) 때문에 기울기가 약해질** 수 있음.

**언제 쓰나**:

- 확률적 출력(캘리브레이션)과 빠른 수렴, 선형 로지스틱 회귀에서는 **BCE**가 표준.
- 회귀/확률 예측의 제곱오차 자체를 평가(Brier score)하고 싶거나, 특수한 설정에서 안정성이 필요한 경우 **MSE**를 고려.

---

## A. 용어사전(Glossary)

- **시그모이드(Sigmoid)**: $sigma(z)=\frac{1}{1+e^{-z}}$. 실수를 (0,1) 확률로 매핑.
- **로그잇(Logit)**: $z=\mathbf{w}^\top\mathbf{x}+b$. 시그모이드 입력(선형 점수).
- **크로스 엔트로피(Cross-Entropy)**: 두 분포 간의 불일치를 측정하는 함수. 이진에서는 $−[y\log q+(1-y)\log(1-q)]$.
- **음의 로그우도(NLL)**: $\log p_\theta(y|\mathbf{x})$. BCE는 베르누이 우도의 NLL과 일치.
- **볼록(Convex)**: 한 점에서의 접선 위로 함수가 놓이는 형태. 전역 최적해 탐색이 쉬움.
- **포화(Saturation)**: |z|가 커져 $\sigma(z)$가 0이나 1에 가까워지며 $\sigma'(z)\to 0$로 기울기 소실.
- **브라이어 점수(Brier score)**: 이진 확률 예측의 MSE, $(q-y)^2$.

---

## B. 큰 그림(What/Why/How)

**What**:

입력 $\mathbf{x}\in\mathbb{R}^d$가 들어오면 선형 결합 $z=\mathbf{w}^\top\mathbf{x}+b$ → 시그모이드 $q=\sigma(z)$ → 손실 $L(y,q)$로 학습.

**Why** (왜 BCE가 더 흔한가):

1. **기울기 세기**: BCE는 $\frac{\partial L}{\partial z}=q-y$로 시그모이드 도함수 $\sigma'(z)$가 소거되어 **포화 영역에서도 학습 신호가 살아있음**. MSE는 $\frac{\partial L}{\partial z}=(q-y)q(1-q)$라 포화 시 **기울기 약화**.
2. **벌점의 스케일**: BCE는 틀린 확신(예: 정답 1인데 $q\approx 0$)에 **강력한 페널티**($\log q\to\infty$). MSE는 최대 오차가 제한적.
3. **볼록성**: 단층 선형 로지스틱 회귀(은닉층 없음)에서는 BCE가 파라미터 $(w,b)$에 대해 **볼록**이라 최적화가 수월. MSE는 일반적으로 **비볼록**.

**How** (학습 메커니즘 3–5단계):

1. $z=\mathbf{w}^\top\mathbf{x}+b$ 계산 → $q=\sigma(z).$
2. 손실 $L_{\text{BCE}}=-[y\log q+(1-y)\log(1-q)]$ 또는 $L_{\text{MSE}}=\frac{1}{2}(q-y)^2$.
3. 기울기 $\partial L/\partial z$ 산출($BCE: q-y; MSE:(q-y)q(1-q)$).
4. $\frac{\partial L}{\partial \mathbf{w}} \;=\; \frac{\partial L}{\partial z} \,\mathbf{x}, 
\qquad
\frac{\partial L}{\partial b} \;=\; \frac{\partial L}{\partial z}$.
5. 옵티마이저(SGD/Adam 등)로 파라미터 업데이트.

**So what**:

- 오답을 빠르게 교정하고 싶고 확률적 추론의 일관성을 원하면 **BCE**.
- 제곱오차 기반의 평가/연구 목적(브라이어 점수 등)이라면 **MSE**도 의미.