# Grad-CAM

소유자: 주헌 박

# 핵심 아이디어

- Grad-CAM은 분류·캡셔닝·VQA 등 폭넓은 CNN 계열 모델에서, “관심 클래스의 점수”가 마지막 합성곱층(feature map)으로 역전파되는 **그래디언트**를 이용해, 그 결정에 기여한 이미지 영역을 **클래스 구분적(class-discriminative)** 열지도(로컬라이제이션 맵)로 보여줍니다. 네트워크 구조 변경이나 재학습이 필요 없습니다.

# 방법(간단 수식/절차)

1. 관심 클래스 (c)의 점수 (y_c) (소프트맥스 전) 를 마지막 합성곱층의 활성화 (A_k)에 대해 미분하고, 공간 차원 ((i,j))에 대해 **전역 평균 풀링**하여 채널별 중요도 (\alpha_k^c)를 얻습니다.
    
    [
    
    \alpha_k^c=\frac{1}{Z}\sum_{i}\sum_{j}\frac{\partial y_c}{\partial A_{ij}^{k}}
    
    ]
    
2. 그 가중치로 순전파 활성화 맵을 선형결합한 뒤 **ReLU**를 적용해(긍정적 증거만 남기기) Grad-CAM 맵 (L_{\text{Grad-CAM}}^{c})를 만듭니다.
    
    [
    
    L_{\text{Grad-CAM}}^{c}=\mathrm{ReLU}\Big(\sum_k \alpha_k^c A^k\Big)
    
    ]
    
    이때 ReLU를 빼면 다른 클래스의 음성 증거까지 섞여 지역화 성능이 떨어집니다.
    

# Guided Grad-CAM

- 픽셀단 그래디언트 기반의 **Guided Backprop**(세밀하지만 클래스 구분성이 약함)과 Grad-CAM(클래스 구분은 뛰어나나 해상도가 낮음)을 **요소곱**으로 결합해, **고해상도이면서도 클래스 구분적인** 시각화를 얻습니다.

# CAM 대비 차별점

- CAM은 “GAP→Softmax” 형태의 특수 아키텍처를 요구해 적용 범위가 제한됩니다. Grad-CAM은 **임의의 CNN 기반 모델**에 적용 가능하며, 완전합성곱 구조에서는 CAM이 Grad-CAM의 특수한 경우가 됩니다. 또한 **부분 역전파 한 번**으로 효율적으로 지역화합니다.

# 성능·실험 포인트

- **약지도(weakly-supervised) 지역화**(ILSVRC-15 val): VGG-16, AlexNet, GoogLeNet에서 기존 기법(c-MWP, 이미지 공간 그래디언트+grab-cut, CAM 등) 대비 더 낮은 지역화 오류를 보이며, 분류 성능 저하 없이 달성합니다.
- **세그멘테이션 시드**로 사용 시(PASCAL VOC 2012, SEC 손실), CAM 시드 대비 IoU를 44.6→49.6으로 향상시킵니다.
- **VQA/캡셔닝** 등 비분류·멀티모달 모델에도 적용되어, 주의 메커니즘이 없는 모델조차 답변에 필요한 영역을 잘 집어냄을 정량·정성적으로 보입니다(오클루전 맵 상관, 휴먼 어텐션 상관 등).
- **카운터팩추얼 설명**: 그래디언트를 부호 반전해 “예측을 바꾸게 만들 증거”를 강조하는 맵도 생성할 수 있습니다.
- 전반적 결론: 해석가능성과 모델 충실도(faithfulness)를 모두 개선하고, 실패 모드·데이터 바이어스를 진단하는 도구로 유용합니다.

# 기여 요약

1. **일반적·비침습적 시각화**: 구조 변경/재학습 없이 모든 CNN 기반 모델에 적용 가능한 클래스 구분 로컬라이제이션.
2. **Guided Grad-CAM**으로 고해상도+클래스 구분 결합.
3. **실패 분석·바이어스 진단**과 **ResNet·VQA·캡셔닝** 등 다양한 모델로의 확장.

---