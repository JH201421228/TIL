# SAM

소유자: 주헌 박

# 핵심 요약

- **문제 정의 – 프롬프트 가능한 분할(Promptable Segmentation)**: 사용자(또는 다른 알고리즘)가 던지는 다양한 형태의 프롬프트(점/박스/기존 마스크/텍스트)에 대해, 모호함이 있더라도 “합리적인” 객체 마스크를 즉시 반환하는 일반화된 분할 과제를 제안합니다. 이는 프롬프트 엔지니어링만으로 새로운 데이터 분포·다운스트림 작업에 제로샷 전이하도록 설계된 과제입니다.
- **모델 – SAM(Segment Anything Model)**: 강력한 **이미지 인코더**(ViT 기반)로 이미지 임베딩을 한 번 만들고, **프롬프트 인코더**로 입력 프롬프트를 임베딩한 뒤, **라이트급 마스크 디코더**가 마스크를 예측하는 단순·모듈형 구조입니다. 모호성 대응을 위해 하나의 프롬프트에 대해 **여러 개(기본 3개)**의 유효 마스크와 신뢰도(예상 IoU)를 함께 출력하도록 학습했습니다. 브라우저·CPU 기준 프롬프트 처리 지연은 약 수십 ms 수준으로 상호작용에 적합하게 설계했습니다.
- **데이터 엔진 & 데이터셋 – SA-1B**: 웹에 자연히 풍부하지 않은 “분할 마스크”를 대규모로 모으기 위해, 모델을 루프에 넣어 **보조 수동 → 반자동 → 완전 자동**의 3단계 데이터 엔진을 구축했습니다. 그 결과 **1.1B(11억) 마스크 / 1,100만 장 이미지**의 초대규모·고다양성 데이터셋 **SA-1B**를 자동으로 생성·검증했습니다(사생활 보호 처리 포함). 이는 기존 세그멘테이션 데이터셋 대비 **마스크 수 400배+** 수준의 규모입니다.
- **제로샷 전이 성능**: 23개 다양한 분할 벤치마크에서 단일 점 프롬프트만으로도 강력한 마스크 품질을 보였고(모호성 때문에 자동 IoU 지표가 과소평가될 수 있어 **사람 평가**도 수행), **엣지 검출**, **오브젝트 프로포절(AR@1000)**, **인스턴스 분할(탐지 박스→마스크)**, **텍스트→마스크(개념 증명)** 등 본래 학습 과제와 다른 작업에도 프롬프트 구성만으로 제로샷 전이가 가능함을 보였습니다. 일부 설정에선 기존 완전지도 기법에 근접하거나 능가하는 결과도 관찰됩니다.
- **설계 철학 – 조합성과 인터페이스**: SAM은 “유효 마스크를 빠르게 내놓는” 안정적 인터페이스를 제공하기 때문에, 탐지기·시선추적·로봇 인식 등 **다른 모듈과 조합**해 새로운 응용을 쉽게 만들 수 있는 **비전용 파운데이션 구성요소**로 포지셔닝됩니다.
- **한계와 관찰**: 매우 가는 구조물 누락, 드물게 작은 허상 컴포넌트 생성, 데이터셋 고유 편향(예: COCO/LVIS의 마스크 관례)을 학습해 점수 “게임”하는 모델과의 지표 괴리 등은 남아 있습니다. 또한 텍스트→마스크는 초기 결과이며, 소형 객체에선 전용 기법이 유리한 경우가 있습니다.
- **릴리스**: 모델(SAM, Apache-2.0 라이선스)과 데이터셋(SA-1B)은 연구용으로 공개되어 **비전 파운데이션 모델 연구**를 촉진하려는 목적을 갖습니다.